{"ast":null,"code":"import { Compra } from 'src/app/Modelo/Compra';\nimport { ProdcutosCompra } from 'src/app/Modelo/ProductosCompra';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/Service/compras.service\";\nimport * as i2 from \"src/app/Service/productos.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction ComprasComponent_div_0_option_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pr_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", pr_r6.codigo);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\"C.\", pr_r6.codigo, \": \", pr_r6.nombre, \", en bodega (\", pr_r6.cantidad_bodega, \")\");\n  }\n}\nfunction ComprasComponent_div_0_tr_46_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const pc_r8 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pc_r8.id_compra);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pc_r8.producto);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pc_r8.cantidad);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pc_r8.precio_unitario);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(pc_r8.subtotal);\n  }\n}\nfunction ComprasComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"div\", 14)(2, \"div\", 15)(3, \"div\", 16)(4, \"nav\", 17)(5, \"h3\", 18);\n    i0.ɵɵtext(6, \"Nueva Compra\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 19)(8, \"form\", 20, 21);\n    i0.ɵɵlistener(\"ngSubmit\", function ComprasComponent_div_0_Template_form_ngSubmit_8_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.agregarProductoACompra());\n    });\n    i0.ɵɵelementStart(10, \"div\", 22)(11, \"label\", 23);\n    i0.ɵɵtext(12, \"Seleccione el producto:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"select\", 24);\n    i0.ɵɵlistener(\"ngModelChange\", function ComprasComponent_div_0_Template_select_ngModelChange_13_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.productoSeleccionado = $event);\n    });\n    i0.ɵɵtemplate(14, ComprasComponent_div_0_option_14_Template, 2, 4, \"option\", 25);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(15, \"br\");\n    i0.ɵɵelementStart(16, \"div\", 22)(17, \"label\", 26);\n    i0.ɵɵtext(18, \"Ingrese el precio de compra del producto:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"input\", 27);\n    i0.ɵɵlistener(\"ngModelChange\", function ComprasComponent_div_0_Template_input_ngModelChange_19_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.precioProducto = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(20, \"br\");\n    i0.ɵɵelementStart(21, \"div\", 22)(22, \"label\", 28);\n    i0.ɵɵtext(23, \"Ingrese la cantidad del producto:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"input\", 29);\n    i0.ɵɵlistener(\"ngModelChange\", function ComprasComponent_div_0_Template_input_ngModelChange_24_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.cantidadProducto = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(25, \"br\");\n    i0.ɵɵelementStart(26, \"div\")(27, \"button\", 30);\n    i0.ɵɵelement(28, \"i\", 31);\n    i0.ɵɵtext(29, \" Agregar\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(30, \"h3\");\n    i0.ɵɵtext(31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"table\", 10)(33, \"thead\")(34, \"tr\")(35, \"th\");\n    i0.ɵɵtext(36, \"Compra\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(37, \"th\");\n    i0.ɵɵtext(38, \"Nombre producto\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(39, \"th\");\n    i0.ɵɵtext(40, \"Cantidad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(41, \"th\");\n    i0.ɵɵtext(42, \"Precio unitario\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(43, \"th\");\n    i0.ɵɵtext(44, \"Subtotal\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(45, \"tbody\");\n    i0.ɵɵtemplate(46, ComprasComponent_div_0_tr_46_Template, 11, 5, \"tr\", 12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"h3\");\n    i0.ɵɵtext(48, \"Precio total 111\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const _r3 = i0.ɵɵreference(9);\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(13);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.productoSeleccionado);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.productos);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.precioProducto);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r0.cantidadProducto);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", !_r3.form.valid);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Productos en la compra \", ctx_r0.codigoNuevaCompra, \"\");\n    i0.ɵɵadvance(15);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.productosNuevaCompra);\n  }\n}\nfunction ComprasComponent_tr_33_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\", 11)(10, \"button\", 32);\n    i0.ɵɵlistener(\"click\", function ComprasComponent_tr_33_Template_button_click_10_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const compra_r15 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.verDetalles(compra_r15));\n    });\n    i0.ɵɵelement(11, \"i\", 33);\n    i0.ɵɵtext(12, \" Detalles\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const compra_r15 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(compra_r15.codigo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(compra_r15.sucursal);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(compra_r15.fecha);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(compra_r15.total_compra);\n  }\n}\nexport class ComprasComponent {\n  constructor(servicioCompras, servicioProductos) {\n    this.servicioCompras = servicioCompras;\n    this.servicioProductos = servicioProductos;\n    this.mostrarNuevaCompra = false;\n  }\n  ngOnInit() {\n    this.servicioCompras.getCompras(this.getRolDB()).subscribe(data => {\n      this.compras = data;\n      this.traerProductos();\n    }, error => {\n      console.log(error);\n      this.traerProductos();\n    });\n  }\n  verDetalles(compra) {}\n  filtrarCompras(filtro) {\n    console.log(\"filtro: \" + filtro);\n  }\n  getRolDB() {\n    let stringUser = localStorage.getItem('usuario');\n    let usuario = stringUser ? JSON.parse(stringUser) : null;\n    let rol = usuario ? usuario.rol : 0;\n    return rol;\n  }\n  getIDUser() {\n    let stringUser = localStorage.getItem('usuario');\n    let usuario = stringUser ? JSON.parse(stringUser) : null;\n    let rol = usuario ? usuario.identificacion : 0;\n    return rol;\n  }\n  getSucursal() {\n    let stringUser = localStorage.getItem('usuario');\n    let usuario = stringUser ? JSON.parse(stringUser) : null;\n    let suc = usuario ? usuario.sucursal : 0;\n    return suc;\n  }\n  nuevaCompra() {\n    //hacer que se agregue una nueva compra\n    this.productosNuevaCompra = [];\n    this.mostrarNuevaCompra = true;\n    let compra = new Compra();\n    compra.usuario = this.getIDUser();\n    compra.sucursal = this.getSucursal();\n    this.servicioCompras.nuevaCompra(compra, this.getRolDB()).subscribe(data => {\n      this.codigoNuevaCompra = data.codigo_compra;\n      console.log(this.codigoNuevaCompra);\n    }, error => {\n      console.log(error);\n    });\n  }\n  traerProductosNuevaCompra(idC) {\n    this.servicioProductos.getProductosNuevaCompra(idC, this.getRolDB()).subscribe(data => {\n      this.productosNuevaCompra = data;\n    }, error => {\n      console.log(error);\n    });\n  }\n  agregarProductoACompra() {\n    let pc = new ProdcutosCompra(this.codigoNuevaCompra, parseInt(this.productoSeleccionado), this.cantidadProducto, this.precioProducto);\n    this.servicioProductos.nuevoProductoCompra(pc, this.getRolDB()).subscribe(data => {\n      console.log(data);\n      this.traerProductosNuevaCompra(this.codigoNuevaCompra);\n    }, error => {\n      console.log(error);\n    });\n  }\n  traerProductos() {\n    this.servicioProductos.getProductosSucursal(this.getSucursal(), this.getRolDB()).subscribe(data => {\n      this.productos = data;\n    }, error => {\n      console.log(error);\n    });\n  }\n  static #_ = this.ɵfac = function ComprasComponent_Factory(t) {\n    return new (t || ComprasComponent)(i0.ɵɵdirectiveInject(i1.ComprasService), i0.ɵɵdirectiveInject(i2.ProductosService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ComprasComponent,\n    selectors: [[\"app-compras\"]],\n    decls: 34,\n    vars: 6,\n    consts: [[\"class\", \"container mt-2 col-md-10\", 4, \"ngIf\"], [1, \"container\", \"mt-5\", \"pt-5\"], [1, \"card\"], [1, \"card-header\", \"d-flex\", \"justify-content-between\", \"align-items-center\"], [1, \"me-4\"], [\"aria-label\", \"Default select example\", \"id\", \"combo\", 1, \"form-select\", \"me-3\", 3, \"click\"], [\"combofiltro\", \"\"], [3, \"value\"], [\"aria-label\", \"Agregar compra\", 1, \"btn\", \"btn-primary\", \"ms-3\", 3, \"click\"], [1, \"bi\", \"bi-cart-plus-fill\", \"bi-xxl\"], [1, \"table\", \"table-bordered\"], [1, \"text-center\"], [4, \"ngFor\", \"ngForOf\"], [1, \"container\", \"mt-2\", \"col-md-10\"], [1, \"row\"], [1, \"col\"], [1, \"card\", \"my-10\"], [1, \"navbar\", \"navbar-expand-lg\", \"bg-white\", \"navbar-light\", \"py-3\", \"py-lg-0\", \"px-lg-5\"], [1, \"mt-2\", \"me-4\"], [1, \"card-body\"], [3, \"ngSubmit\"], [\"nuevaCompraForm\", \"ngForm\"], [1, \"form-group\"], [\"for\", \"rol\"], [\"aria-label\", \"Default select example\", \"id\", \"combo\", \"name\", \"comoboProductos\", \"required\", \"\", 1, \"form-select\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"precio\"], [\"type\", \"number\", \"name\", \"precio\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"cantidad\"], [\"type\", \"number\", \"name\", \"cantidad\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"disabled\"], [1, \"bi\", \"bi-add\"], [1, \"btn\", \"btn-warning\", \"me-2\", \"col-sm-5\", 3, \"click\"], [1, \"bi\", \"bi-eye\"]],\n    template: function ComprasComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        const _r19 = i0.ɵɵgetCurrentView();\n        i0.ɵɵtemplate(0, ComprasComponent_div_0_Template, 49, 7, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"h3\");\n        i0.ɵɵtext(4);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"div\", 3)(6, \"h5\", 4);\n        i0.ɵɵtext(7, \"Filtrar\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"select\", 5, 6);\n        i0.ɵɵlistener(\"click\", function ComprasComponent_Template_select_click_8_listener() {\n          i0.ɵɵrestoreView(_r19);\n          const _r1 = i0.ɵɵreference(9);\n          return i0.ɵɵresetView(ctx.filtrarCompras(_r1.value));\n        });\n        i0.ɵɵelementStart(10, \"option\", 7);\n        i0.ɵɵtext(11, \"Todas\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"option\", 7);\n        i0.ɵɵtext(13, \"Las de Hoy\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"option\", 7);\n        i0.ɵɵtext(15, \"Variable\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(16, \"button\", 8);\n        i0.ɵɵlistener(\"click\", function ComprasComponent_Template_button_click_16_listener() {\n          return ctx.nuevaCompra();\n        });\n        i0.ɵɵelement(17, \"i\", 9);\n        i0.ɵɵtext(18, \" Agregar \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"table\", 10)(20, \"thead\")(21, \"tr\")(22, \"th\");\n        i0.ɵɵtext(23, \"Codigo\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(24, \"th\");\n        i0.ɵɵtext(25, \"Sucursal\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"th\");\n        i0.ɵɵtext(27, \"Fecha de compra\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"th\");\n        i0.ɵɵtext(29, \"Total\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"th\", 11);\n        i0.ɵɵtext(31, \"ACCIONES\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelementStart(32, \"tbody\");\n        i0.ɵɵtemplate(33, ComprasComponent_tr_33_Template, 13, 4, \"tr\", 12);\n        i0.ɵɵelementEnd()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.mostrarNuevaCompra);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\"Totales (\", ctx.compras.length, \") \");\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"value\", 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", 1);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", 2);\n        i0.ɵɵadvance(19);\n        i0.ɵɵproperty(\"ngForOf\", ctx.compras);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm],\n    styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"mappings":"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","names":["Compra","ProdcutosCompra","i0","ComprasComponent","constructor","servicioCompras","servicioProductos","ngOnInit","getCompras","getRolDB","subscribe","data","compras","traerProductos","error","console","log","verDetalles","compra","filtrarCompras","filtro","stringUser","localStorage","getItem","usuario","JSON","parse","rol","getIDUser","identificacion","getSucursal","suc","sucursal","nuevaCompra","productosNuevaCompra","mostrarNuevaCompra","codigoNuevaCompra","codigo_compra","traerProductosNuevaCompra","idC","getProductosNuevaCompra","agregarProductoACompra","pc","parseInt","productoSeleccionado","cantidadProducto","precioProducto","nuevoProductoCompra","getProductosSucursal","productos","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/eiler/Documentos/Universidad/SegundoSemestre2024/Archivos/Proyecto1/app/FRONTEND/src/app/area-bodega/compras/compras.component.ts","/home/eiler/Documentos/Universidad/SegundoSemestre2024/Archivos/Proyecto1/app/FRONTEND/src/app/area-bodega/compras/compras.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { Compra } from 'src/app/Modelo/Compra';\nimport { ComprasService } from 'src/app/Service/compras.service';\nimport { Usuario } from 'src/app/Modelo/Usuario';\nimport { data, error } from 'jquery';\nimport { Producto } from 'src/app/Modelo/Producto';\nimport { ProductosService } from 'src/app/Service/productos.service';\nimport { ProdcutosCompra } from 'src/app/Modelo/ProductosCompra';\n@Component({\n  selector: 'app-compras',\n  templateUrl: './compras.component.html',\n  styleUrls: ['./compras.component.css']\n})\nexport class ComprasComponent {\n  constructor(private servicioCompras:ComprasService, private servicioProductos:ProductosService){}\n  compras!:Compra[]\n  mostrarNuevaCompra:boolean=false;\n  productos!:Producto[]\n\n  precioProducto!:number\n  cantidadProducto!:number\n  productoSeleccionado!:any\n\n  codigoNuevaCompra!:number\n\n  productosNuevaCompra !:ProdcutosCompra[]\n\n  ngOnInit():void{\n    this.servicioCompras.getCompras(this.getRolDB()).subscribe(data=>{\n      this.compras=data;\n      this.traerProductos();\n    }, error=>{\n      console.log(error)\n      this.traerProductos();\n    })\n  }\n  verDetalles(compra:Compra){\n\n  }\n\n  filtrarCompras(filtro:string){\n    console.log(\"filtro: \" + filtro)\n  }\n\n  getRolDB(){\n    let stringUser = localStorage.getItem('usuario');\n    let usuario:Usuario = stringUser? JSON.parse(stringUser):null;\n    let rol = usuario? usuario.rol:0;\n    return rol;\n  }\n  getIDUser(){\n    let stringUser = localStorage.getItem('usuario');\n    let usuario:Usuario = stringUser? JSON.parse(stringUser):null;\n    let rol = usuario? usuario.identificacion:0;\n    return rol;\n  }\n  getSucursal(){\n    let stringUser = localStorage.getItem('usuario');\n    let usuario:Usuario = stringUser? JSON.parse(stringUser):null;\n    let suc = usuario? usuario.sucursal:0;\n    return suc;\n  }\n\n  nuevaCompra(){\n    //hacer que se agregue una nueva compra\n    this.productosNuevaCompra= []\n    this.mostrarNuevaCompra=true;\n    let compra = new Compra();\n    compra.usuario=this.getIDUser();\n    compra.sucursal=this.getSucursal();\n    this.servicioCompras.nuevaCompra(compra,this.getRolDB()).subscribe(data=>{\n      this.codigoNuevaCompra=data.codigo_compra;\n      console.log(this.codigoNuevaCompra)\n      \n    },error=>{\n      console.log(error)\n    })\n  }\n\n  traerProductosNuevaCompra(idC:number){\n    this.servicioProductos.getProductosNuevaCompra(idC,this.getRolDB()).subscribe(data=>{\n      this.productosNuevaCompra=data;\n    },error=>{\n      console.log(error)\n    })\n  }\n\n  agregarProductoACompra() {\n    let pc = new ProdcutosCompra(this.codigoNuevaCompra,parseInt(this.productoSeleccionado),this.cantidadProducto,this.precioProducto);\n    this.servicioProductos.nuevoProductoCompra(pc,this.getRolDB()).subscribe(data=>{\n      console.log(data);\n      this.traerProductosNuevaCompra(this.codigoNuevaCompra);\n    }, error=>{\n      console.log(error)\n    })\n  }\n\n  traerProductos(){\n    this.servicioProductos.getProductosSucursal(this.getSucursal(),this.getRolDB()).subscribe(data=>{\n      this.productos=data;\n    }, error=>{\n      console.log(error)\n    })\n  }\n}\n","\n\n<div class=\"container mt-2 col-md-10\" *ngIf=\"mostrarNuevaCompra\">\n    <div class=\"row\">\n        <div class=\"col\">\n            <div class=\"card my-10\">\n                <nav class=\"navbar navbar-expand-lg bg-white navbar-light py-3 py-lg-0 px-lg-5\">\n                    <h3 class=\"mt-2 me-4\">Nueva Compra</h3>\n                </nav>\n\n                <div class=\"card-body\">\n                    <form (ngSubmit)=\"agregarProductoACompra()\"  #nuevaCompraForm=\"ngForm\">\n                        \n                        <div class=\"form-group\">\n                            <label for=\"rol\">Seleccione el producto:</label>\n                            <select class=\"form-select\" aria-label=\"Default select example\" id=\"combo\"  name=\"comoboProductos\" required [(ngModel)]=\"productoSeleccionado\">\n                                <option *ngFor=\"let pr of productos; let i = index\" [value]=\"pr.codigo\">C.{{pr.codigo}}:  {{pr.nombre}}, en bodega ({{pr.cantidad_bodega}})</option>\n                            </select>\n                        </div>\n                        <br>\n                        <div class=\"form-group\">\n                            <label for=\"precio\">Ingrese el precio de compra del producto:</label>\n                            <input type=\"number\" class=\"form-control\" name=\"precio\" [(ngModel)]=\"precioProducto\"  required>\n                        </div>                        \n                        <br>\n                        <div class=\"form-group\">\n                            <label for=\"cantidad\">Ingrese la cantidad del producto:</label>\n                            <input type=\"number\" class=\"form-control\" name=\"cantidad\" [(ngModel)]=\"cantidadProducto\"  required>\n                        </div>                        \n                        <br>\n                        <div>\n                            <button type=\"submit\" class=\"btn btn-success\"\n                                [disabled]=\"!nuevaCompraForm.form.valid\"><i class=\"bi bi-add\"></i> Agregar</button>\n                        </div> \n                    </form>\n                </div>\n                <h3>Productos en la compra {{codigoNuevaCompra}}</h3>\n                <table class=\"table table-bordered\">\n                    <thead>\n                        <tr>\n                            <th>Compra</th>\n                            <th>Nombre producto</th>\n                            <th>Cantidad</th>\n                            <th>Precio unitario</th>\n                            <th>Subtotal</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr *ngFor=\"let pc of productosNuevaCompra; let i = index\">\n                            <td>{{pc.id_compra}}</td>\n                            <td>{{pc.producto}}</td>\n                            <td>{{pc.cantidad}}</td>\n                            <td>{{pc.precio_unitario}}</td>\n                            <td>{{pc.subtotal}}</td>\n                        </tr>\n                        \n                    </tbody>\n                </table>\n                <h3>Precio total 111</h3>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"container mt-5 pt-5\">\n    <div class=\"card\">\n        <h3>Totales ({{compras.length}}) </h3>\n        <div class=\"card-header d-flex justify-content-between align-items-center\">\n            <h5 class=\"me-4\">Filtrar</h5>\n            <select class=\"form-select me-3\"  aria-label=\"Default select example\" id=\"combo\" #combofiltro (click)=\"filtrarCompras(combofiltro.value)\">\n                <option [value]=\"0\">Todas</option>\n                <option [value]=\"1\">Las de Hoy</option>\n                <option [value]=\"2\">Variable</option>\n            </select>\n            <button class=\"btn btn-primary ms-3\" aria-label=\"Agregar compra\" (click)=\"nuevaCompra()\">\n                <i class=\"bi bi-cart-plus-fill bi-xxl\"></i> Agregar\n            </button>\n            \n        </div>\n        \n        <table class=\"table table-bordered\">\n            <thead>\n                <tr>\n                    <th>Codigo</th>\n                    <th>Sucursal</th>\n                    <th>Fecha de compra</th>\n                    <th>Total</th>\n                    <th class=\"text-center\">ACCIONES</th>\n                </tr>\n            </thead>\n            <tbody>\n                <tr *ngFor=\"let compra of compras; let i = index\">\n                    <td>{{compra.codigo}}</td>\n                    <td>{{compra.sucursal}}</td>\n                    <td>{{compra.fecha}}</td>\n                    <td>{{compra.total_compra}}</td>\n                    <td class=\"text-center\">\n                        <button class=\"btn btn-warning me-2 col-sm-5\" (click)=\"verDetalles(compra)\"> <i class=\"bi bi-eye\"></i>      Detalles</button>\n                    </td>\n                </tr>\n            </tbody>\n        </table>\n    </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}